# Increment this version number whenever the schema of discovery.yml is changed.
# See https://www.meltano.com/docs/contributing.html#discovery-yml-version for more information.
version: 8

extractors:
  - name: tap-carbon-intensity
    label: Carbon Emissions Intensity
    description: National Grid ESO's Carbon Emissions Intensity API
    namespace: tap_carbon
    docs: 'https://meltano.com/plugins/extractors/carbon-intensity.html'
    pip_url: 'git+https://gitlab.com/meltano/tap-carbon-intensity'
    capabilities:
      - discover
  - name: tap-csv
    label: CSV
    description: Generic data extractor of CSV (comma separated value) files
    namespace: tap_csv
    hidden: true
    docs: 'https://meltano.com/plugins/extractors/csv.html'
    pip_url: 'git+https://gitlab.com/meltano/tap-csv.git'
    capabilities:
      - discover
      - state
    settings:
      - name: csv_files_definition
        env: TAP_CSV_FILES_DEFINITION
        label: CSV Files Definition
        placeholder: Ex. files-def.json
        documentation: https://gitlab.com/meltano/tap-csv#run
  - name: tap-facebook
    label: Facebook Ads
    description: Advertising Platform
    namespace: tap_facebook
    docs: 'https://meltano.com/plugins/extractors/facebook.html'
    pip_url: 'git+https://gitlab.com/meltano/tap-facebook.git'
    capabilities:
      - properties
      - discover
      - state
    settings_group_validation:
      - ['account_id', 'access_token', 'start_date']
    settings:
      - name: account_id
        label: Account ID
        placeholder: Ex. 123456789012345
        description: Your Facebook Ads Account ID
      - name: access_token
        label: Access Token
        placeholder: Ex. *****************
        description: User Token generated by Facebook OAuth handshake
        kind: password
      - name: start_date
        description: Determines how much historical data will be extracted. Please be aware that the larger the time period and amount of data, the longer the initial extraction can be expected to take.
        kind: date_iso8601
      - name: end_date
        kind: date_iso8601
      - name: insights_buffer_days
        label: Ads Insights Buffer Days
        value: 0
        kind: hidden
        description: How many Days before the Start Date to fetch Ads Insights for
  - name: tap-fastly
    label: Fastly
    description: Edge cloud computing services provider
    namespace: tap_fastly
    docs: 'https://meltano.com/plugins/extractors/fastly.html'
    pip_url: 'git+https://gitlab.com/meltano/tap-fastly.git'
    capabilities:
      - catalog
      - discover
      - state
    settings:
      - name: api_token
        label: API Token
        kind: password
        placeholder: Ex. *****************
      - name: start_date
        label: Start Date
        kind: date_iso8601
  - name: tap-gitlab
    label: GitLab
    description: Single application for the entire DevOps lifecycle
    namespace: tap_gitlab
    docs: 'https://meltano.com/plugins/extractors/gitlab.html'
    pip_url: 'git+https://gitlab.com/meltano/tap-gitlab.git'
    capabilities:
      - discover
      - state
    settings_group_validation:
      - ['api_url', 'private_token', 'groups', 'start_date']
      - ['api_url', 'private_token', 'projects', 'start_date']
    settings:
      - name: api_url
        label: GitLab Instance
        value: 'https://gitlab.com'
        protected: true
      - name: private_token
        label: Access Token
        kind: password
        placeholder: Ex. *****************
        env: GITLAB_API_TOKEN
      - name: groups
        value: ''
        placeholder: Ex. my-organization
        env: GITLAB_API_GROUPS
      - name: projects
        value: ''
        placeholder: Ex. my-organization/project-1
        env: GITLAB_API_PROJECTS
      - name: ultimate_license
        value: false
        kind: boolean
        env: GITLAB_API_ULTIMATE_LICENSE
      - name: start_date
        env: GITLAB_API_START_DATE
        kind: date_iso8601
  - name: tap-google-analytics
    label: Google Analytics
    description: App and website analytics platform hosted by Google
    namespace: tap_google_analytics
    docs: 'https://meltano.com/plugins/extractors/google-analytics.html'
    pip_url: 'git+https://gitlab.com/meltano/tap-google-analytics.git'
    capabilities:
      - catalog
      - discover
      - state
    settings_group_validation:
      - ['key_file_location', 'view_id', 'start_date']
    settings:
      - name: key_file_location
        label: Key File Location
        placeholder: Ex. client_secrets.json
        kind: file
        env: GOOGLE_ANALYTICS_API_CLIENT_SECRETS
      - name: view_id
        label: View ID
        placeholder: Ex. 198343027
        env: GOOGLE_ANALYTICS_API_VIEW_ID
        label: View ID
      - name: reports
        label: Reports
        placeholder: Ex. my_report_definition.json
        kind: file
        env: GOOGLE_ANALYTICS_API_REPORTS
      - name: start_date
        env: GOOGLE_ANALYTICS_API_START_DATE
        kind: date_iso8601
      - name: end_date
        env: GOOGLE_ANALYTICS_API_END_DATE
        kind: date_iso8601
  - name: tap-marketo
    label: Marketo
    description: Marketing automation for account-based marketing
    namespace: tap_marketo
    hidden: true
    docs: 'https://meltano.com/plugins/extractors/marketo.html'
    pip_url: 'git+https://gitlab.com/meltano/tap-marketo.git'
    capabilities: []
    settings:
      - name: identity
      - name: client_id
        label: Client ID
      - name: client_secret
        kind: password
      - name: endpoint
      - name: start_date
        description: Determines how much historical data will be extracted. Please be aware that the larger the time period and amount of data, the longer the initial extraction can be expected to take.
        kind: date_iso8601
  - name: tap-mongodb
    label: MongoDB
    description: General purpose, document-based, distributed database
    namespace: tap_mongodb
    hidden: true
    docs: 'https://meltano.com/plugins/extractors/mongodb.html'
    pip_url: 'git+https://github.com/singer-io/tap-mongodb.git'
    capabilities:
      - catalog
      - discover
      - state
    settings:
      - name: host
        label: Host URL
        value: localhost
        protected: true
      - name: port
        value: 27017
      - name: user
        env: MONGODB_USERNAME
      - name: password
        kind: password
      - name: dbname
        label: Database Name
  - name: tap-salesforce
    label: Salesforce
    description: Customer-relationship management & customer success platform
    namespace: tap_salesforce
    docs: 'https://meltano.com/plugins/extractors/salesforce.html'
    pip_url: 'git+https://gitlab.com/meltano/tap-salesforce.git'
    capabilities:
      - properties
      - discover
      - state
    select:
      - Lead.*
      - Contact.*
      - User.*
      - OpportunityHistory.*
      - Account.*
      - Opportunity.*
    settings:
      - name: username
        label: User Name
        placeholder: Ex. me@my-organization.com
      - name: password
        label: Password
        placeholder:  Ex. *****************
        kind: password
      - name: security_token
        label: Security Token
        placeholder: Ex. *****************
        description: Your Salesforce Account access token
        documentation: https://meltano.com/plugins/extractors/salesforce.html#salesforce-setup
        kind: password
      - name: api_type
        label: API Type
        value: REST
        kind: hidden
        placeholder: Ex. REST
      - name: select_fields_by_default
        label: Select Fields by Default
        value: true
        kind: hidden
        description: Select by default any new fields discovered in Salesforce objects
      - name: start_date
        description: Determines how much historical data will be extracted. Please be aware that the larger the time period and amount of data, the longer the initial extraction can be expected to take.
        kind: date_iso8601
  - name: tap-stripe
    label: Stripe
    description: Online payment processing for internet businesses
    namespace: tap_stripe
    docs: 'https://meltano.com/plugins/extractors/stripe.html'
    pip_url: 'git+https://github.com/meltano/tap-stripe.git@v0.2.4'
    capabilities:
      - catalog
      - discover
      - state
    settings:
      - name: account_id
        label: Account ID
        placeholder: Ex. me@my-organization.com
        env: STRIPE_ACCOUNT_ID
        placeholder: Ex. act_1a2b3c4d5e
      - name: client_secret
        label: Secret API Key
        kind: password
        placeholder: Ex. *****************
        env: STRIPE_API_KEY
        placeholder: Ex. sk_live_1a2b3c4d5e
      - name: start_date
        description: Determines how much historical data will be extracted. Please be aware that the larger the time period and amount of data, the longer the initial extraction can be expected to take.
        kind: date_iso8601
  - name: tap-zendesk
    label: Zendesk
    description: Support ticketing system & customer service platform
    namespace: tap_zendesk
    docs: 'https://meltano.com/plugins/extractors/zendesk.html'
    pip_url: 'tap-zendesk'
    capabilities:
      - catalog
      - discover
      - state
    settings:
      - name: email
        placeholder: Ex. me@my-organization.com
        kind: email
      - name: api_token
        label: API Token
        placeholder: Ex. *****************
        kind: password
        documentation: https://support.zendesk.com/hc/en-us/articles/226022787-Generating-a-new-API-token-
      - name: subdomain
        label: Zendesk Subdomain
        placeholder: Ex. my-subdomain.zendesk.com
        documentation: https://support.zendesk.com/hc/en-us/articles/221682747-Where-can-I-find-my-Zendesk-subdomain-
      - name: start_date
        description: Determines how much historical data will be extracted. Please be aware that the larger the time period and amount of data, the longer the initial extraction can be expected to take.
        kind: date_iso8601
loaders:
  - name: target-csv
    label: CSV
    description: CSV loader
    namespace: target_csv
    hidden: true
    docs: 'https://meltano.com/plugins/loaders/csv.html'
    pip_url: git+https://gitlab.com/meltano/target-csv.git
    settings:
      - name: delimiter
        kind: options
        options:
          - label: Comma (,)
            value: ','
          - label: Tab (  )
            value: '\t'
          - label: Semi-colon (;)
            value: ';'
          - label: Pipes (|)
            value: '|'
        value: ','
        description: A one-character string used to separate fields. It defaults to a comma (,).
      - name: quotechar
        kind: options
        options:
          - label: Single Quote (')
            value: "'"
          - label: Double Quote (")
            value: '"'
        value: "'"
        description: A one-character string used to quote fields containing special characters, such as the delimiter or quotechar, or which contain new-line characters. It defaults to single quote (').
  - name: target-snowflake
    label: Snowflake
    description: Snowflake database loader
    namespace: snowflake
    hidden: true
    docs: 'https://meltano.com/plugins/loaders/snowflake.html'
    pip_url: 'git+https://gitlab.com/meltano/target-snowflake.git'
    signup_url: 'https://trial.snowflake.com?referrer=meltano'
    settings:
      - name: account
        env: SF_ACCOUNT
        description: This is automatically provided by Snowflake and can be found in the URL.
      - name: username
        env: SF_USER
        description: The username you use for logging in
      - name: password
        env: SF_PASSWORD
        kind: password
        description: The password you use for logging in
      - name: role
        env: SF_ROLE
        description: The role that you have assigned privileges for database access
      - name: database
        env: SF_DATABASE
        description: The name of the Snowflake database you want to use
      - name: warehouse
        env: SF_WAREHOUSE
        description: The name of the Snowflake warehouse you want to use
  - name: target-postgres
    label: PostgreSQL
    description: PostgreSQL database loader
    namespace: postgres
    docs: 'https://meltano.com/plugins/loaders/postgres.html'
    pip_url: 'git+https://github.com/meltano/target-postgres.git'
    settings:
      - name: user
        env: PG_USERNAME
        value: warehouse
      - name: password
        kind: password
        env: PG_PASSWORD
        value: warehouse
      - name: host
        env: PG_ADDRESS
        value: localhost
        protected: true
      - name: port
        env: PG_PORT
        value: 5502
      - name: dbname
        label: Database Name
        env: PG_DATABASE
        value: warehouse
  - name: target-sqlite
    label: SQLite
    description: SQLite database loader
    namespace: sqlite
    hidden: true
    docs: 'https://meltano.com/plugins/loaders/sqlite.html'
    pip_url: 'git+https://gitlab.com/meltano/target-sqlite.git'
    settings:
      - name: database
        label: Database Name
        description: '"warehouse" is the default name of the SQLite loader database generated at the project root. Feel free to rename it.'
        value: warehouse
transformers:
  - name: dbt
    namespace: dbt
    pip_url: dbt==0.14.4
transforms:
  - name: tap-carbon-intensity
    namespace: tap_carbon
    pip_url: 'https://gitlab.com/meltano/dbt-tap-carbon-intensity.git'
    vars:
      entry_table: "{{ env_var('MELTANO_LOAD_SCHEMA') }}.entry"
      generationmix_table: "{{ env_var('MELTANO_LOAD_SCHEMA') }}.generationmix"
      region_table: "{{ env_var('MELTANO_LOAD_SCHEMA') }}.region"
  - name: tap-salesforce
    namespace: tap_salesforce
    pip_url: 'https://gitlab.com/meltano/dbt-tap-salesforce.git'
    vars:
      schema: "{{ env_var('MELTANO_LOAD_SCHEMA') }}"
  - name: tap-facebook
    namespace: tap_facebook
    pip_url: 'https://gitlab.com/meltano/dbt-tap-facebook.git'
    vars:
      schema: "{{ env_var('MELTANO_LOAD_SCHEMA') }}"
  - name: tap-gitlab
    namespace: tap_gitlab
    pip_url: 'https://gitlab.com/meltano/dbt-tap-gitlab.git'
    vars:
      schema: "{{ env_var('MELTANO_LOAD_SCHEMA') }}"
      ultimate_license: "{{ env_var('GITLAB_API_ULTIMATE_LICENSE', False) }}"
  - name: tap-stripe
    namespace: tap_stripe
    pip_url: 'https://gitlab.com/meltano/dbt-tap-stripe.git'
    vars:
      livemode: false
      schema: "{{ env_var('MELTANO_LOAD_SCHEMA') }}"
  - name: tap-zendesk
    namespace: tap_zendesk
    pip_url: 'https://gitlab.com/meltano/dbt-tap-zendesk.git'
    vars:
      schema: "{{ env_var('MELTANO_LOAD_SCHEMA') }}"
  - name: tap-google-analytics
    namespace: tap_google_analytics
    pip_url: 'https://gitlab.com/meltano/dbt-tap-google-analytics.git'
    vars:
      schema: "{{ env_var('MELTANO_LOAD_SCHEMA') }}"
models:
  - name: model-carbon-intensity
    namespace: tap_carbon
    pip_url: 'git+https://gitlab.com/meltano/model-carbon-intensity.git'
  - name: model-facebook
    namespace: tap_facebook
    pip_url: 'git+https://gitlab.com/meltano/model-facebook.git'
  - name: model-salesforce
    namespace: tap_salesforce
    pip_url: 'git+https://gitlab.com/meltano/model-salesforce.git'
  - name: model-gitflix
    namespace: tap_gitflix
    pip_url: 'git+https://gitlab.com/jschatz1/model-gitflix.git'
  - name: model-zendesk
    namespace: tap_zendesk
    pip_url: 'git+https://gitlab.com/meltano/model-zendesk.git'
  - name: model-gitlab
    namespace: tap_gitlab
    pip_url: 'git+https://gitlab.com/meltano/model-gitlab.git'
  - name: model-gitlab-ultimate
    namespace: tap_gitlab_ultimate
    pip_url: 'git+https://gitlab.com/meltano/model-gitlab-ultimate.git'
  - name: model-stripe
    namespace: tap_stripe
    pip_url: 'git+https://gitlab.com/meltano/model-stripe.git'
  - name: model-google-analytics
    namespace: tap_google_analytics
    pip_url: 'git+https://gitlab.com/meltano/model-google-analytics.git'
orchestrators:
  - name: airflow
    namespace: airflow
    pip_url: 'apache-airflow==1.10.2'
    settings:
      - name: core.dags_folder
        value: $MELTANO_PROJECT_ROOT/orchestrate/dags
        env: AIRFLOW__CORE__DAGS_FOLDER
      - name: core.plugins_folder
        value: $MELTANO_PROJECT_ROOT/orchestrate/plugins
        env: AIRFLOW__CORE__DAGS_FOLDER
      - name: core.sql_alchemy_conn
        value: sqlite:///.meltano/orchestrators/airflow/airflow.db
        env: AIRFLOW__CORE__SQL_ALCHEMY_CONN
      - name: core.load_examples
        value: False
        env: AIRFLOW__CORE__LOAD_EXAMPLES
      - name: core.dags_are_paused_at_creation
        env: AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION
        value: False
